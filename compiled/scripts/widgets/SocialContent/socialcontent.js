require.config({shim:{"widgets/socialcontent/jquery.bxslider.min":{deps:["modules/jquery-mozu"]},"widgets/socialcontent/remodal.min":{deps:["modules/jquery-mozu"]}}}),define(["modules/jquery-mozu","underscore","modules/api","modules/backbone-mozu","hyprlivecontext","widgets/SocialContent/socialcontent-feed","widgets/SocialContent/socialcontent-helpers","widgets/SocialContent/jquery.bxslider.min","widgets/SocialContent/remodal.min"],function(e,t,n,o,i,r,d){var a,l,c,s=0,u=0,p=null,m=function(e){return"undefined"!=typeof e&&(s=e),s},g=function(e){return"undefined"!=typeof e&&(u=e),u},f=function(){return"object"!=typeof l?l=e("#socialcontent-widget").data("mz-socialcontent"):l},w=f(),h=r.getSocialContentFeeds({nameSpace:"mzint",feedId:w.associatedFeed}),y=function(){var t=m();h.getFeedItems(t,25,w.associatedFeed).then(function(n){n=n.data,e.each(n.items,function(e,t){t.properties.actionLink=v(t.properties.link,w.associatedFeed),t.properties.actionLinkString=JSON.stringify(t.properties.actionLink),t.config=w,t.timeElapsed=d.timeElapsed(t.properties.createDate),x.add(new k(t))}),m(t+n.items.length),g(g()+n.items.length),a.trigger("feedItemLoadComplete"),e("#loading-block, #loading-block-wrapper").hide()},function(){e("#loading-block, #loading-block-wrapper").hide()})},v=function(t,n){var o={};return"object"==typeof t&&e.each(t,function(e,t){return t.associatedFeed===n?(o=t,!1):void 0}),o},k=o.MozuModel.extend({defaults:{data:{},maxCharLength:150}}),x=new o.Collection,S=new o.Collection,b=o.MozuView.extend({templateName:"Widgets/social/socialcontent-feed-grid",getRenderContext:function(){var e=o.MozuView.prototype.getRenderContext.apply(this,arguments);return e},events:{"click img":"clicked"},clicked:function(t){t.preventDefault();var n=e(t.currentTarget).data("cid"),o=this.model.get(n),i=o.get("properties");i.config=w,i.timeElapsed=d.timeElapsed(i.createDate),L(i)},render:function(){o.MozuView.prototype.render.apply(this,arguments)}}),z=o.MozuView.extend({templateName:"Widgets/social/socialcontent-feed-carousel",getRenderContext:function(){var e=o.MozuView.prototype.getRenderContext.apply(this,arguments);return e},events:{"click img":"clicked"},clicked:function(t){t.preventDefault();var n=e(t.currentTarget).data("cid"),o=this.model.get(n),i=o.get("properties");i.config=w,i.timeElapsed=d.timeElapsed(i.createDate),L(i)},render:function(){o.MozuView.prototype.render.apply(this,arguments)}}),C=o.MozuView.extend({templateName:"Widgets/social/socialcontent-feed-mobile",getRenderContext:function(){var e=o.MozuView.prototype.getRenderContext.apply(this,arguments);return e},render:function(){o.MozuView.prototype.render.apply(this,arguments)}}),M=o.MozuView.extend({templateName:"Widgets/social/socialcontent-model-window",getRenderContext:function(){var e=o.MozuView.prototype.getRenderContext.apply(this,arguments);return e},render:function(){o.MozuView.prototype.render.apply(this,arguments)}}),L=function(t){S.reset(),S.add(new k(t));var n=new M({model:S,el:e(".remodal")});n.render(),p?p.open():T()},T=function(){var t={};p=e("[data-remodal-id=modal]").remodal(t)},V=function(){var e=new C({model:x,el:a});e.on("add",function(){C.render()}),e.render()},R=function(){var e;return w.carouselFormat?(e=new z({model:x,el:a}),e.on("add",function(){z.render()}),e.render(),j(),void 0):(e=new b({model:x,el:a}),e.on("add",function(){b.render()}),e.render(),q(1e3),setTimeout(F,100),void 0)},j=function(){c&&c.reloadSlider(),c=e(".socialcontent-widget-wrapper .feed-item-wrapper .social-feed-items").bxSlider({mode:"horizontal",slideWidth:200,minSlides:2,maxSlides:w.carouselColumns,slideMargin:0,pager:!1,onSlideNext:function(e,t,n){n>c.getSlideCount()&&(y(),c.goToSlide(n))}})},F=function(){c&&c.reloadSlider(),c=e(".socialcontent-widget-wrapper .feed-item-wrapper .social-feed-items").bxSlider({mode:"vertical",slideWidth:1e3,minSlides:2,maxSlides:w.gridRows,slideMargin:0,pager:!1,onSlideNext:function(e,t,n){n>c.getSlideCount()&&(y(),c.goToSlide(n))}})},N=function(){return"mobile"===w.templateType?(V(),void 0):(R(),void 0)},q=function(t){{var n,o=e("#socialGrid"),i=o.find("img");i.clone()}1024>t&&(n=4),768>t&&(n=3),400>t&&(n=2),t>1024&&(n=w.gridColumns),i.unwrap();for(var r=0;r<i.length;r+=n)i.slice(r,r+n).wrapAll("<div class='slide columns-"+n+"'></div>")};e(document).ready(function(){a=e("[data-mz-socialcontent] .feed-item-wrapper"),a.on("feedItemLoadComplete",function(){N()}),a.on("click",".call-to-action a",function(t){t.preventDefault();var n,o=e(this).parent(".call-to-action").data("action-link");if("object"==typeof o){if("mobile"===w.templateType)return n=d.mobileURLByLink(o.mobileLink),window.location.href=n,void 0;n=d.desktopURLByLink(o.desktopLink),window.location.href=n}}),y(),T();var t=0,n=function(){t=500},o=function(){t=0};"mobile"===w.templateType&&(e(".socialcontent-widget-wrapper").height(e(window).height()),e(window).height()!==e("body").height()&&(e("body").height(e(window).height()),e("body").css("overflow","hidden")),e("#socialcontent-widget").scroll(function(){e("#isocialcontent-widget").scrollTop()+e("#socialcontent-widget").height()>e(".feed-item-wrapper").outerHeight()+e(".feed-intro-text").outerHeight()&&0===t&&(n(),window.setTimeout(function(e){e()}(o),t),y())})),"desktop"===w.templateType&&w.gridFormat&&e(window).resize(function(){var t=e(".socialcontent-widget-wrapper").width();1050>t&&(q(t),setTimeout(c.reloadSlider,100))})})});