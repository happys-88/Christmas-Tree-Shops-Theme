function BNLog(){this.timeBase=(new Date).getTime(),this.lines=new Array,this.lastLine="",this.repCount=0}function BNCriticalSectionQueue(){this.waitList=new Object,this.lastId=0}function BNCriticalSection(e){this.csQueue=e,this.debug=1}function BNResourceManager(e){this.csQueue=new BNCriticalSectionQueue,this.critSec=null,this.debug=1,this.resources=new Object,this.waiting=new Object,this.onloadInjected=!1,this.strategy="undefined"!=typeof e?e:Strategy.ScriptDOMInject}function BNSystem(){this.testServer=null}function BNTag(e){e?(this.id=e.id+1,this.server=e.server,this.customerId=e.customerId,this.code=e.code):this.id=0,this.attrs=new Object,this.docAttrs=new Object,this.css=new Object}function bnReadySignal(){bnResourceManager.registerResource(BN_READY_SIGNAL)}function bnCall(e,t,n){var o=bnResourceManager.getResource(e);if(!o)return bnResourceManager.waitForResource(e,function(){bnCall(e,t,n)}),void 0;if("object"==typeof o){var i=o[t];"function"==typeof i&&i.call(o,n)}}function bnWaitForCustomerStatus(e){if(!bnCheckCustomerStatus()){var t=baynote_tag.getFailsafeResourceId();return bnResourceManager.waitForResource(t,function(){bnWaitForCustomerStatus(e)},baynote_tag.getFailsafeResourceAddress(),"img"),void 0}bnResourceManager.runCallback(e)}function bnCheckCustomerStatus(){var e=baynote_tag.getFailsafeResourceId();return bnResourceManager.getResource(e)?!0:!1}var BaynoteJSVersion="Version: V1222-03",BaynoteIgnored=!1,BN_READY_SIGNAL="ReadySignal",Strategy={ScriptDOMInject:2,OnLoadInject:3};if("undefined"==typeof baynote_globals)var baynote_globals=new Object;if(baynote_globals.CommonResourceURL="/baynote/tags3/common",baynote_globals.CommonResourceID="Common",baynote_globals.PolicyResourceID="Policy",baynote_globals.CustomerStatus="/baynote/customerstatus2",baynote_globals.CommonScriptId="commonScriptId",baynote_globals.DefaultInjectStrategy="undefined"!=typeof baynote_inject_strategy?baynote_inject_strategy:Strategy.ScriptDOMInject,baynote_globals.ServerTimeout="undefined"!=typeof baynote_server_timeout?baynote_server_timeout:void 0,baynote_globals.UseWindowName="undefined"!=typeof baynote_use_window_name?baynote_use_window_name:!1,baynote_globals.waitForReady=!1,baynote_globals.checkStatus=!1,baynote_globals.keepTrail=!1,baynote_globals.trailLength=5,bnIsOpera=navigator.userAgent.indexOf("Opera")>=0,bnIsSafari=navigator.userAgent.indexOf("AppleWebKit")>=0,bnIsKonqueror=navigator.userAgent.indexOf("Konqueror")>=0,bnIsKHTML=bnIsSafari||bnIsKonqueror||navigator.userAgent.indexOf("KHTML")>=0,bnIsIE=navigator.userAgent.indexOf("compatible")>=0&&navigator.userAgent.indexOf("MSIE")>=0&&!bnIsOpera,bnIsMozilla=navigator.userAgent.indexOf("Gecko")>=0&&!bnIsKHTML,BNLog.prototype.log=function(e){if(e==this.lastLine)return++this.repCount,void 0;this.repCount>0&&this.lines.push("___ ABOVE REPEATED "+this.repCount+" TIME"+(this.repCount>1?"S":"")),this.lastLine=e,this.repCount=0;var t=(new Date).getTime()-this.timeBase;this.lines.push(t+": "+e)},BNLog.prototype.toString=function(){return this.repCount>0&&(this.lines.push("___ ABOVE REPEATED "+this.repCount+" TIME"+(this.repCount>1?"S":"")),this.lastLine="",this.repCount=0),this.lines.join("\n")},"undefined"==typeof bnLog)var bnLog=new BNLog;if(BNCriticalSectionQueue.prototype.issueId=function(){return++this.lastId},BNCriticalSectionQueue.prototype.enqueue=function(e,t){this.waitList[e]=t},BNCriticalSectionQueue.prototype.getWaiter=function(e){return null==e?null:this.waitList[e]},BNCriticalSectionQueue.prototype.firstWaiter=function(){return this.getWaiter(this.nextWaiterKeyAfter(null))},BNCriticalSectionQueue.prototype.nextWaiterAfter=function(e){return this.getWaiter(this.nextWaiterKeyAfter(e))},BNCriticalSectionQueue.prototype.nextWaiterKeyAfter=function(e){for(var t in this.waitList)if("object"==typeof this.waitList[t]){if(null==e)return t;e==t&&(e=null)}return null},BNCriticalSectionQueue.prototype.nextPredecessor=function(e,t){for(var n=t;null!=n;n=this.nextWaiterAfter(n.id))if(n.enter||0!=n.number&&(n.number<e.number||n.number==e.number&&n.id<e.id))return n;return null},BNCriticalSection.prototype.enter=function(e){this.enterFunc=e,this.id=this.csQueue.issueId(),this.csQueue.enqueue(this.id,this),this.enter=!0,this.number=(new Date).getTime(),this.enter=!1,this.attempt(this.csQueue.firstWaiter())},BNCriticalSection.prototype.leave=function(){this.debug&&bnLog.log("LEAVE "+this.id),this.number=0},BNCriticalSection.prototype.attempt=function(e){var t=this.csQueue.nextPredecessor(this,e);if(null!=t){this.debug&&bnLog.log("WAIT "+this.id);var n=this;return setTimeout(function(){n.attempt(t)},50)}this.debug&&bnLog.log("ENTER "+this.id),this.enterFunc()},BNResourceManager.prototype.getResource=function(e){return this.resources[e]},BNResourceManager.prototype.loadResource=function(e,t,n,o,i){if("undefined"==typeof this.resources[e]){this.resources[e]=null;var r=new BNCriticalSection(this.csQueue);r.enter(function(){bnResourceManager.inject(e,t,n,r,o,i)})}},BNResourceManager.prototype.inject=function(e,t,n,o,i,r){return this.critSec=o,this.debug&&bnLog.log("INJECT "+this.critSec.id+" ("+e+")"),"undefined"!=typeof n&&"script"!=n&&"img"!=n?(bnLog.log("Unexpected resource type to loadResource: "+n),void 0):(this.defaultInject(e,t,n,i,r),void 0)},BNResourceManager.prototype.defaultInject=function(e,t,n,o,i){if(!BaynoteIgnored)if(n&&"script"!=n){if("img"==n){var r=document.createElement("IMG"),a=function(){bnResourceManager.registerAndAddResource(e,r)};r.addEventListener?r.addEventListener("load",a,!1):r.attachEvent?r.attachEvent("onload",a):r.onload=a,r.src=t,r.style.display="none";var s=document.getElementsByTagName("body"),u=s[0];setTimeout(function(){null!=u&&u.appendChild(r)},5)}}else{if(this.strategy==Strategy.OnLoadInject&&(e==baynote_globals.CommonResourceID||e==baynote_globals.PolicyResourceID)&&!this.onloadInjected){var c=function(){bnResourceManager.injectHandler(e,t,o,i)};return window.addEventListener?window.addEventListener("load",c,!1):window.attachEvent?window.attachEvent("onload",c):window.onload=c,this.onloadInjected=!0,void 0}this.injectHandler(e,t,o,i)}},BNResourceManager.prototype.injectHandler=function(e,t,n,o,i){if(!this.resources[e]){if("undefined"!=typeof i)return i.src="","function"==typeof o&&o(),BaynoteIgnored=!0,bnLog.log("FATAL: Treating Baynote as down. Resource '"+e+"' took more than "+n+" mSec"),void 0;var r=document.createElement("script");setTimeout(function(){var e=document.getElementsByTagName("head");r.language="javascript",r.src=t,e[0].appendChild(r)},50),(void 0===n||null===n)&&(n=baynote_globals.ServerTimeout),"undefined"!=typeof n&&setTimeout(function(){bnResourceManager.injectHandler(e,t,n,o,r)},n)}},BNResourceManager.prototype.waitForResource=function(rId,callbackCode,rAddress,rType,timeout,failureFunc){with(this)if(getResource(rId))this.runCallback(callbackCode);else{"undefined"==typeof waiting[rId]&&(waiting[rId]=new Array);var waitingList=waiting[rId];waitingList[waitingList.length]=callbackCode,rAddress&&this.loadResource(rId,rAddress,rType,timeout,failureFunc)}},BNResourceManager.prototype.wakeUpWaiting=function(rId){with(this){var waitingList=waiting[rId];if(!waitingList)return;for(var i=0;i<waitingList.length;i++)if(waitingList[i]){var codeToEval=waitingList[i];waitingList[i]=null,this.debug&&codeToEval&&bnLog.log("CALLBACK "+rId+": "+codeToEval),this.runCallback(codeToEval)}}},BNResourceManager.prototype.registerAndAddResource=function(e,t){this.debug&&bnLog.log("REGISTER "+(this.critSec?this.critSec.id:"")+" ("+e+")"),this.resources[e]=t,this.wakeUpWaiting(e),this.critSec&&this.critSec.leave(),setTimeout("bnResourceManager.wakeUpWaiting('"+e+"')",5e3)},BNResourceManager.prototype.registerResource=function(e){this.registerAndAddResource(e,!0)},BNResourceManager.prototype.removeResource=function(e){this.resources[e]=null,delete this.resources[e]},BNResourceManager.prototype.runCallback=function(e){"function"==typeof e?e():alert("Invalid callback, type="+typeof e)},"undefined"==typeof bnResourceManager)var bnResourceManager=new BNResourceManager(baynote_globals.DefaultInjectStrategy);if(BNSystem.prototype.getCookieValue=function(e,t){t||(t=baynote_globals.cookieSubDomain),t&&(e+="-"+t);var n="(?:; )?"+e+"=([^;]*);?",o=new RegExp(n);return o.test(document.cookie)?decodeURIComponent(RegExp.$1):null},BNSystem.prototype.setCookie=function(e,t,n,o,i,r){if(t=encodeURIComponent(t),"NEVER"==o){var a=new Date;a.setFullYear(a.getFullYear()+500),o=a.toGMTString()}else"SESSION"==o&&(o="");""!=n&&(n=";Path="+n),""!=o&&(o=";expires="+o),i||(i=baynote_globals.cookieDomain?baynote_globals.cookieDomain:""),""!=i&&(i=";domain="+i),r||(r=baynote_globals.cookieSubDomain),r&&(e+="-"+r);var s=e+"="+t+o+n+i;return s.length>4096?!1:(document.cookie=s,!0)},BNSystem.prototype.removeCookie=function(e,t){this.setCookie(e,"","/","Mon, 1 Jan 1990 00:00:00",t)},BNSystem.prototype.getURLParam=function(e,t){if(!t)var t=window.location.href;var n=new RegExp("[\\?&]"+e+"=([^&#]*)"),o=n.exec(t);return o?o[1]:null},BNSystem.prototype.getTestServer=function(){if(null!=this.testServer)return this.testServer;var e=this.getCookieValue("bn_test");return e||(e=""),this.testServer=e,e},"undefined"==typeof bnSystem)var bnSystem=new BNSystem;if(BNTag.prototype.getCommonResourceId=function(){return baynote_globals.CommonResourceID},BNTag.prototype.getCommonResourceAddress=function(e){var t="?";for(var n in e)"server"!=n&&(t+=n+"="+encodeURIComponent(e[n])+"&");var o=t.substring(0,t.length-1),i=this.server+baynote_globals.CommonResourceURL+o;return i},BNTag.prototype.getFailsafeResourceId=function(){return"Failsafe"},BNTag.prototype.getFailsafeResourceAddress=function(){var e=BaynoteJSVersion.split(" ")[1],t=bnSystem.getCookieValue("bn_u");return this.server+baynote_globals.CustomerStatus+"?customerId="+this.customerId+"&code="+this.code+"&v="+e+"&u="+t},BNTag.prototype.getParam=function(e,t){var n=this[e];return"undefined"==typeof n||null==n?t:n},"undefined"==typeof baynote_tag){window.bn_tags=new Array;var baynote_tag=new BNTag(null)}var BaynoteAPI={};BaynoteAPI.getURLParam=function(e,t){return bnSystem.getURLParam(e,t)},BaynoteAPI.init=function(e){if(!(e&&e.server&&e.customerId&&e.code))return bnLog.log("ERROR: init called with insufficient arguments - needs server, customerId, code"),void 0;e.timeout||(e.timeout=baynote_globals.ServerTimeout),e.onFailure||(e.onFailure=baynote_globals.onFailure);var t=bnSystem.getTestServer();if(t){var n=new RegExp("^https?://[^/]*\\.baynote\\.(com|net):?\\d*(/.*)?$");n.test(t)?e.server=t:bnLog.log('Ignoring invalid test server "'+t+'"')}e.server&&(baynote_tag.server=e.server),e.customerId&&(baynote_tag.customerId=e.customerId),e.code&&(baynote_tag.code=e.code);var o=baynote_tag.getCommonResourceId();bnResourceManager.getResource(o)?BaynoteIgnored||bnCommon.completePreload(e):bnResourceManager.waitForResource(o,function(){BaynoteAPI.init(e)},baynote_tag.getCommonResourceAddress(e),"script",e.timeout,e.onFailure)},BaynoteAPI.execute=function(e,t){var n=baynote_tag.getCommonResourceId();return"undefined"==typeof bnResourceManager.getResource(n)?(bnLog.log("WARN: common not loaded - exiting execute; consider calling init first"),void 0):"undefined"==typeof bnCommon?(bnResourceManager.waitForResource(n,function(){BaynoteAPI.execute(e,t)}),void 0):(bnCommon.waitAndExecute(e,t),void 0)},BaynoteAPI.executeAll=function(e){var t=baynote_tag.getCommonResourceId();return"undefined"==typeof bnResourceManager.getResource(t)?(bnLog.log("WARN: common not loaded - exiting executeAll; consider calling init first"),void 0):"undefined"==typeof bnCommon?(bnResourceManager.waitForResource(t,function(){BaynoteAPI.executeAll(e)}),void 0):(bnCommon.waitAndExecuteAll(e),void 0)},BaynoteAPI.call=function(e,t,n,o){var i=baynote_tag.getCommonResourceId();return"undefined"==typeof bnResourceManager.getResource(i)?(bnLog.log("WARN: common not loaded - exiting call; consider calling init first"),void 0):"undefined"==typeof bnCommon?(bnResourceManager.waitForResource(i,function(){BaynoteAPI.call(e,t,n,o)}),void 0):(bnCommon.finishCall(e,t,n,o),void 0)},BaynoteAPI.isBaynoteIgnored=function(){return BaynoteIgnored},BaynoteAPI.getCookieDomain=function(){var e="",t=window.location.href,n=t.indexOf("//"),o=t.substring(n+2),i=o.indexOf("/");if(0>i)var r=o;else var r=o.substring(0,i);var a=r.indexOf("."),s=r.substring(a+1);return e=s},baynote_globals.cookieDomain=BaynoteAPI.getCookieDomain();var preLoadObj={},bn_locHref=window.location.href;preLoadObj.server=0==bn_locHref.indexOf("https://")?"https://costplus-cts.baynote.net":"http://costplus-cts.baynote.net",preLoadObj.customerId="costplus",preLoadObj.code="cts",BaynoteAPI.init(preLoadObj),("undefined"==typeof baynoteObserver||"boolean"!=typeof baynoteObserver||baynoteObserver)&&BaynoteAPI.execute("observer"),("undefined"==typeof baynoteGuide||"boolean"!=typeof baynoteGuide||baynoteGuide)&&BaynoteAPI.execute("recommendation"),"undefined"==typeof baynoteDisableAjax||"boolean"!=typeof baynoteDisableAjax||baynoteDisableAjax||BaynoteAPI.execute("ajax");